"use strict";(self.webpackChunksolidity_demo=self.webpackChunksolidity_demo||[]).push([[97],{4600:function(e,n){n.Z={Demo1Address:"0x565532db18dc4ac35af3eef7905a1bdb97ddea85",Demo2Address:"0x56843b09891615d03c0ae7728498562a6f21dad1"}},5097:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var r=t(7166),s=t(3032),a=t(678),i=t(2791),o=t(7027),c=t(7309),u=t(8717),l=t(8185),d=t(2835),m=t(43),h=t(7106),p=t(9601),f=t(1087),x=t(2487),v=t(184);function g(e){var n=e.account,t=e.initEthers,g=e.etherInfo,j=e.getList,w=(0,i.useRef)(null),Z=(0,i.useState)(!1),b=(0,a.Z)(Z,2),y=b[0],k=b[1],N=(0,v.jsx)(h.Z,{style:{fontSize:24},spin:!0}),C=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window,s=n.ethereum,window.ethereum){e.next=4;break}return o.ZP.error("\u8bf7\u5148\u5b89\u88c5metamask"),e.abrupt("return");case 4:return e.prev=4,e.next=7,s.request({method:"eth_requestAccounts"});case 7:e.sent.length&&t(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),o.ZP.error(e.t0.message),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){g&&I()}),[g]);var I=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t,s,a,i,c,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window,s=t.ethereum,a=g.demo1Contract,i=g.signer,s){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,console.log(p.parseEther(n.amount)._hex+""),k(!0),console.log("value",p.parseUnits(n.amount+"",18)._hex),e.next=10,i.sendTransaction({to:n.recipient,value:p.parseUnits(n.amount+"",18)._hex,gasLimit:"0x5208"});case 10:return e.next=12,a.setInfoArray(n.recipient,p.parseUnits(n.amount+"",18)._hex,n.message,n.keyword);case 12:return c=e.sent,e.next=15,c.wait();case 15:return e.next=17,a.getInfoMapping();case 17:u=e.sent,k(!1),console.log(u,"infoList"),j(),w.current.resetFields(),e.next=29;break;case 24:e.prev=24,e.t0=e.catch(4),o.ZP.error(e.t0.message),console.error(e.t0),k(!1);case 29:case"end":return e.stop()}}),e,null,[[4,24]])})));return function(n){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{className:"demo-top-wrap",children:[(0,v.jsxs)("div",{className:"demo-top-left",children:[(0,v.jsxs)("div",{className:"left-title",children:["Welcome !",(0,v.jsx)("br",{}),"send your transaction in this demo"]}),(0,v.jsx)("div",{className:"left-btn",children:n?(0,v.jsx)(c.ZP,{style:{background:"rgb(26,28,48)",color:"#1677ff",borderColor:"#1677ff"},variant:"outlined",color:"primary",children:"\u5df2\u8fde\u63a5metamask\u8d26\u6237"}):(0,v.jsx)(c.ZP,{onClick:C,style:{background:"rgb(26,28,48)",color:"rgb(245, 239, 239)"},variant:"contained",color:"primary",children:"Connect Wallet"})}),(0,v.jsxs)("div",{className:"left-other",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)(f.rU,{to:"https://reactjs.org/",children:"React.js"}),(0,v.jsx)(f.rU,{to:"https://ant.design/components/message-cn",children:"Antd"}),(0,v.jsx)(f.rU,{to:"https://learnblockchain.cn/ethers_v5/getting-started/",children:"Ether.js"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)(f.rU,{children:"Web3.0"}),(0,v.jsx)(f.rU,{children:"MetaMask"}),(0,v.jsx)(f.rU,{children:"BlockChain"})]})]})]}),(0,v.jsxs)("div",{className:"demo-top-right",children:[(0,v.jsxs)(u.Z,{title:"",bordered:!1,children:[(0,v.jsx)(x.Z,{style:{color:"white",fontSize:"20px"}}),(0,v.jsx)("div",{className:"account",title:n,children:function(e){var n;return null!==(n=e)&&void 0!==n||(e=""),e.substr(0,5)+"....."+e.substr(-5)}(n)}),(0,v.jsx)("span",{className:"ethereum",children:"Ethereum"})]}),(0,v.jsx)("div",{className:"demo-top-right-bottom",children:(0,v.jsxs)(l.Z,{ref:w,name:"basic",labelCol:{span:8},wrapperCol:{span:16},style:{maxWidth:600},initialValues:{remember:!1},onFinish:E,onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,v.jsx)(l.Z.Item,{name:"recipient",rules:[{required:!0,message:"Please input your Address To!"}],children:(0,v.jsx)(d.Z,{id:"public-input",placeholder:"Address To"})}),(0,v.jsx)(l.Z.Item,{name:"amount",rules:[{required:!0,message:"Please input your Amount!"}],children:(0,v.jsx)(d.Z,{id:"public-input",placeholder:"Amount(ETH)"})}),(0,v.jsx)(l.Z.Item,{name:"keyword",rules:[{required:!0,message:"Please input your keyword!"}],children:(0,v.jsx)(d.Z,{id:"public-input",placeholder:"Keyword(Gif)"})}),(0,v.jsx)(l.Z.Item,{name:"message",rules:[{required:!0,message:"Please input your message!"}],children:(0,v.jsx)(d.Z,{id:"public-input",placeholder:"Enter Message"})}),(0,v.jsx)(l.Z.Item,{children:y?(0,v.jsx)(m.Z,{indicator:N}):(0,v.jsx)(c.ZP,{htmlType:"submit",style:{background:"rgb(26,28,48)",width:"90%",color:"#ccc"},variant:"contained",color:"primary",children:"Send Now"})})]})})]})]})}var j=t(1243);var w=function(e){var n=e.keyword,t=(0,i.useState)(""),o=(0,a.Z)(t,2),c=o[0],u=o[1],l=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t,s,a,i,o,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Z.get("https://api.giphy.com/v1/gifs/search?api_key=eMPhvX5jeWEtOcLrwiqhN5zqi9K80boe&q=".concat(encodeURIComponent(n),"&limit=1&offset=0&rating=g&lang=zh-CN"));case 2:o=e.sent,c=null===o||void 0===o||null===(t=o.data)||void 0===t||null===(s=t.data[0])||void 0===s||null===(a=s.images)||void 0===a||null===(i=a.downsized_medium)||void 0===i?void 0:i.url,u(c);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){n&&l()}),[n]),c};function Z(e,n){e.account,e.initEthers;var t=e.etherInfo,o=((0,i.useRef)(null),(0,i.useState)([])),c=(0,a.Z)(o,2),l=c[0],d=c[1],m=(u.Z.Meta,function(e){var n;return null!==(n=e)&&void 0!==n||(e=""),e.substr(0,5)+"...."+e.substr(-5)});(0,i.useImperativeHandle)(n,(function(){return{getInfo:function(){h()}}})),(0,i.useEffect)((function(){t&&h()}),[t]);var h=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.demo1Contract.getInfoMapping();case 2:n=e.sent,s=n.map((function(e){return{amount:e.amount,sender:e.sender,recipient:e.recipient,keyword:e.keyword,message:e.message,timestamp:new Date(1e3*parseInt(e.timestamp._hex,16)).toLocaleDateString()}})),d(s),console.warn(s,n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{className:"demo-bottom-wrap",children:[(0,v.jsx)("h2",{children:"Latest Transactions"}),(0,v.jsx)("div",{className:"card-list",children:l.map((function(e,n){return(0,v.jsx)(b,{item:e,handleText:m},n)}))})]})}var b=function(e){var n=e.item,t=e.handleText,r=w({keyword:n.keyword});return(0,v.jsxs)("div",{className:"card-item",children:[(0,v.jsxs)("div",{className:"card-info",children:[(0,v.jsxs)("p",{children:["from : \xa0",(0,v.jsx)("span",{children:t(n.sender)})]}),(0,v.jsxs)("p",{children:["to : \xa0",(0,v.jsx)("span",{children:t(n.recipient)})]}),(0,v.jsxs)("p",{children:["Amount : \xa0",(0,v.jsxs)("span",{children:[p.formatEther(n.amount)," ETH"]})]})]}),(0,v.jsx)("p",{className:"time-stamp",children:n.timestamp}),(0,v.jsx)("img",{alt:"example",src:r})]})},y=(0,i.forwardRef)(Z),k=t(9027),N=t(4029),C=t(7896),I=t(4600);function E(){var e=(0,i.useState)(""),n=(0,a.Z)(e,2),t=n[0],o=n[1],c=(0,i.useState)(null),u=(0,a.Z)(c,2),l=u[0],d=u[1],m=(0,i.useRef)(null),h=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n,t,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window,t=n.ethereum,window.ethereum){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.request({method:"eth_accounts"});case 5:(s=e.sent).length&&(o(s[0]),p()),t.on("accountsChanged",(function(e){var n;console.log("accountsChanged",e),o(null!==(n=e[0])&&void 0!==n?n:""),p()}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n,t,s,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new k.Q(window.ethereum),t=n.getSigner(),e.next=4,t.getAddress();case 4:s=e.sent,a=new N.CH(I.Z.Demo1Address,C.Mt,t),d({provider:n,signer:t,address:s,demo1Contract:a});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){h()}),[]),(0,v.jsxs)("div",{className:"demo-wrap",children:[(0,v.jsx)(g,{account:t,initEthers:p,etherInfo:l,getList:function(){m.current.getInfo()}}),(0,v.jsx)(y,{ref:m,account:t,initEthers:p,etherInfo:l})]})}}}]);
//# sourceMappingURL=97.4291754c.chunk.js.map